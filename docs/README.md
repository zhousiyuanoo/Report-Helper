# 🐂 牛马日报助手

一个智能的工作日报管理工具，帮助您高效管理工作日志，自动生成精美报告，并支持飞书集成。

## ✨ 主要特性

### 📝 工作日志管理
- **直观的日志记录界面**：简洁易用的工作日志输入表单
- **智能分类标签**：支持工作内容分类和标签管理
- **时间跟踪**：自动记录工作时间，支持手动调整
- **模板功能**：预设常用工作模板，提高录入效率
- **搜索和筛选**：快速查找历史日志记录
- **批量操作**：支持批量编辑、删除和导出

### 🤖 AI智能报告生成
- **多种报告类型**：支持日报、周报、月报和自定义报告
- **AI内容优化**：基于OpenAI GPT模型智能生成和优化报告内容
- **报告润色**：AI辅助润色，让报告更加专业
- **内容扩展**：根据简要记录自动扩展详细内容
- **格式优化**：自动调整报告格式和结构
- **模板定制**：支持自定义报告模板

### ⏰ 智能提醒系统
- **定时提醒**：可设置多个自定义提醒时间
- **间隔提醒**：按设定间隔自动提醒记录工作
- **工作时间识别**：智能识别工作日和工作时间
- **提醒消息定制**：可自定义提醒内容
- **自动提交**：定时自动生成并提交日报

### 🚀 飞书集成
- **一键发送**：直接将报告发送到飞书群聊
- **多种消息格式**：支持文本、Markdown和卡片消息
- **自动提交**：可设置自动提交到飞书
- **@功能**：支持@所有人或特定用户
- **连接测试**：内置连接测试功能

### 🖥️ 系统托盘运行
- **后台运行**：最小化到系统托盘，不占用任务栏
- **快捷操作**：托盘右键菜单提供常用功能
- **状态显示**：实时显示应用状态和提醒信息
- **开机自启**：支持开机自动启动

## 🛠️ 技术架构

### 核心技术栈
- **界面框架**：PyQt5 - 现代化桌面应用界面
- **AI集成**：OpenAI API - 智能内容生成
- **即时通讯**：飞书开放平台 - 企业协作集成
- **数据存储**：JSON - 轻量级数据持久化
- **配置管理**：python-dotenv - 环境变量管理

### 模块设计
```
牛马日报助手/
├── main.py                 # 主程序入口
├── config_manager.py       # 配置管理模块
├── work_log_window.py      # 工作日志窗口
├── report_window.py        # 报告生成窗口
├── settings_window.py      # 设置窗口
├── system_tray.py          # 系统托盘模块
├── timer_manager.py        # 定时管理模块
├── report_generator.py     # 报告生成器
├── ai_generator.py         # AI生成模块
├── feishu_client.py        # 飞书客户端
└── requirements.txt        # 依赖包列表
```

## 🚀 快速开始

### 环境要求
- Python 3.6+
- Windows 10/11 (推荐)
- 4GB+ 内存
- 100MB+ 磁盘空间

### 安装步骤

1. **克隆或下载项目**
   ```bash
   git clone <repository-url>
   cd Report-Helper
   ```

2. **运行自动安装脚本**
   ```bash
   setup.bat
   ```
   
   或手动安装：
   ```bash
   # 创建虚拟环境
   python -m venv venv
   
   # 激活虚拟环境
   venv\Scripts\activate
   
   # 安装依赖
   pip install -r requirements.txt
   ```

3. **配置环境变量**
   ```bash
   # 复制环境变量模板
   copy .env.example .env
   
   # 编辑.env文件，配置API密钥
   notepad .env
   ```

4. **启动应用程序**
   ```bash
   start.bat
   ```
   
   或直接运行：
   ```bash
   python main.py
   ```

## ⚙️ 详细配置

### 飞书集成配置

1. **创建飞书应用**
   - 访问 [飞书开放平台](https://open.feishu.cn/)
   - 创建企业自建应用
   - 获取 App ID 和 App Secret

2. **配置机器人权限**
   - 启用机器人功能
   - 添加「发送消息」权限
   - 获取机器人的 Chat ID

3. **应用内配置**
   - 打开设置 → 飞书设置
   - 填入 App ID、App Secret 和 Chat ID
   - 点击「测试连接」验证配置

### AI配置

1. **获取OpenAI API密钥**
   - 访问 [OpenAI平台](https://platform.openai.com/)
   - 创建API密钥

2. **配置API参数**
   - 打开设置 → AI设置
   - 填入API密钥和基础URL
   - 选择合适的模型（推荐gpt-3.5-turbo）
   - 调整生成参数（温度、最大Token等）

3. **代理配置（可选）**
   - 如需使用代理，启用代理设置
   - 填入代理地址（如：http://127.0.0.1:7890）

### 提醒配置

1. **基础提醒设置**
   - 设置工作时间（开始时间、结束时间、午休时间）
   - 启用工作日/周末提醒
   - 配置间隔提醒频率

2. **自定义提醒**
   - 添加特定时间的提醒
   - 设置提醒内容
   - 管理提醒列表

3. **自动提交**
   - 设置自动提交时间
   - 选择提交报告类型
   - 配置提交目标（飞书等）

## 🎨 界面预览

### 主界面 - 工作日志
- 简洁的日志录入表单
- 实时的日志列表显示
- 强大的搜索和筛选功能

### 报告生成
- 多种报告类型选择
- AI辅助内容生成
- 实时预览和编辑
- 一键导出和分享

### 设置界面
- 分类清晰的设置选项卡
- 直观的配置界面
- 实时的连接测试

### 系统托盘
- 简洁的托盘图标
- 丰富的右键菜单
- 及时的提醒通知

## 🔧 故障排除

### 常见问题

**Q: 应用程序无法启动**
A: 
1. 检查Python版本是否为3.6+
2. 确认已安装所有依赖包
3. 查看logs目录下的错误日志

**Q: AI功能无法使用**
A:
1. 检查API密钥是否正确配置
2. 确认网络连接正常
3. 如在国内，可能需要配置代理

**Q: 飞书消息发送失败**
A:
1. 验证App ID和App Secret是否正确
2. 确认机器人已添加到目标群聊
3. 检查Chat ID是否正确

**Q: 提醒功能不工作**
A:
1. 确认已启用提醒功能
2. 检查系统时间是否正确
3. 验证工作时间设置

### 日志查看

应用程序会在 `logs/` 目录下生成详细的运行日志：
- `app_YYYYMMDD.log` - 应用程序主日志
- 日志包含详细的错误信息和调试信息

### 数据备份

- 应用数据存储在 `data/` 目录
- 配置文件：`config.json`
- 工作日志：`data/work_logs.json`
- 报告历史：`data/reports/`
- 建议定期备份整个项目目录

## 🤝 贡献指南

我们欢迎任何形式的贡献！

### 如何贡献

1. **Fork 项目**
2. **创建特性分支** (`git checkout -b feature/AmazingFeature`)
3. **提交更改** (`git commit -m 'Add some AmazingFeature'`)
4. **推送到分支** (`git push origin feature/AmazingFeature`)
5. **创建 Pull Request**

### 开发指南

1. **代码规范**
   - 遵循PEP 8代码风格
   - 添加适当的注释和文档字符串
   - 保持代码简洁和可读性

2. **测试**
   - 为新功能添加测试用例
   - 确保所有测试通过
   - 测试不同的使用场景

3. **文档**
   - 更新相关文档
   - 添加新功能的使用说明
   - 保持README的准确性

### 问题报告

如果您发现了bug或有功能建议，请：

1. 检查是否已有相关issue
2. 创建新的issue，详细描述问题
3. 提供复现步骤和环境信息
4. 如可能，提供错误日志

## 📄 许可证

本项目采用 MIT 许可证 - 查看 [LICENSE](LICENSE) 文件了解详情。

## 🙏 致谢

感谢以下开源项目和服务：

- [PyQt5](https://www.riverbankcomputing.com/software/pyqt/) - 强大的Python GUI框架
- [OpenAI](https://openai.com/) - 先进的AI语言模型
- [飞书开放平台](https://open.feishu.cn/) - 企业协作平台
- [python-dotenv](https://github.com/theskumar/python-dotenv) - 环境变量管理
- [requests](https://docs.python-requests.org/) - HTTP库

---

**🐂 让工作日报不再是负担，让AI成为您的得力助手！**

如果这个项目对您有帮助，请给我们一个 ⭐ Star！

有任何问题或建议，欢迎通过 Issues 与我们交流。